version: '3'

tasks:
  run:auth:
    desc: "üöÄ Rodar o servi√ßo user"
    dir: services/auth
    cmds:
      - go run ./cmd/authservice


  build:
    desc: "üì¶ Buildar todos os servi√ßos"
    cmds:
      - go build -o bin/user ./services/user/cmd/user
      - go build -o bin/stock ./services/stock/cmd/stock

  tidy:
    desc: "üßπ Rodar go mod tidy em todos os m√≥dulos"
    cmds:
      - go mod tidy ./services/user
      - go mod tidy ./services/stock
      - go mod tidy ./libs/envconfig

  work:init:
    desc: "üîÑ Recriar o go.work com todos os m√≥dulos"
    cmds:
      - rm -f go.work
      - go work init ./services/* ./libs/*

  lint:
    desc: "üîç Rodar lint com golangci-lint"
    cmds:
      - |
        if ! command -v golangci-lint &> /dev/null; then
          echo "‚ö†Ô∏è  golangci-lint n√£o encontrado. Instale com:"
          echo "go install github.com/golangci/golangci-lint/cmd/golangci-lint@latest"
          exit 1
        fi
        golangci-lint run ./...
